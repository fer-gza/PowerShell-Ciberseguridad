function ValidarArchivo {

    param ([string]$Ruta)

 

    try {

        if (Test-Path $Ruta) {

            $contenido = Get-Content $Ruta -ErrorAction Stop

            return "ðŸ“„ Archivo encontrado y accesible: $Ruta"

        } else {

            throw "El archivo no existe."

        }

    }

    catch {

        return " Error: $_"

    }

    finally {

        Write-Host " ValidaciÃ³n finalizada para: $Ruta" -ForegroundColor Cyan

    }

}



# Prueba de la funciÃ³n

ValidarArchivo -Ruta "C:\archivo_inexistente.txt"

#AsegÃºrate de crear un archivo txt con el nombre archivo en el Escritorio

ValidarArchivo -Ruta "$env:USERPROFILE\Desktop\archivo.txt"